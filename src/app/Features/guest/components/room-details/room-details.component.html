<section class="roomDetails mt-4 " *ngIf="roomRes">
  <div class="container ">
    <div class="row">
      <!--breadcurmb-->
      <div class="col-md-12">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a routerLink="/guest/home">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">Room Details</li>
          </ol>
        </nav>
      </div>
    </div>
    <div class="row d-flex align-items-center justify-content-center">
      <div class="col-lg-4  text-center">
        <div class="roomNumer">
          <h4 class="mb-1 p-1 "> {{roomRes.roomNumber}}</h4>
          <p> Bogor, Indonesia </p>
        </div>
      </div>
    </div>
    <div class="row">
      <owl-carousel-o [options]="sliderOptions">
        <ng-container *ngFor="let item of roomRes?.images">
          <ng-template carouselSlide [id]="roomRes._id">
            <img height="300" [src]="item" alt="room photos">
          </ng-template>
        </ng-container>
      </owl-carousel-o>
    </div>
    <div class="row mt-3 mb-5 ">
      <div class="col-md-6">
        <div class="paragraph p-2">
          <p>
            Minimal techno is a minimalist subgenre of techno music. It is characterized by a stripped-down aesthetic
            that exploits the use of repetition and understated development. Minimal techno is thought to have been
            originally developed in the early 1990s by Detroit-based producers Robert Hood and Daniel Bell.
          </p>
          <p>
            Such trends saw the demise of the soul-infused techno that typified the original Detroit sound. Robert Hood
            has noted that he and Daniel Bell both realized something was missing from techno in the post-rave era.
          </p>
          <p>
            Design is a plan or specification for the construction of an object or system or for the implementation of
            an activity or process, or the result of that plan or specification in the form of a prototype, product or
            process. The national agency for design: enabling Singapore to use design for economic growth and to make
            lives better.
          </p>
        </div>
        <div class="">
          <div *ngIf="roomRes.facilities.length>1">
            <div class="row ">
              <h5>Facilities:</h5>
              <div class="col-sm-3 m-1 ms-5 " *ngFor="let item of roomRes.facilities">
                <div *ngIf="item.name=='Kitchen'"> <i class="fa-solid fa-kitchen-set"></i></div>
                <div *ngIf="item.name=='Garage'"> <i class="fa-solid fa-square-parking"></i></div>
                <div *ngIf="item.name=='Xbox'"> <i class="fa-solid fa-box"></i> </div>
                <div *ngIf="item.name=='Royal suite'"> <i class="fa-solid fa-crown"></i> </div>
                <div *ngIf="item.name=='Wifi' || item.name=='WIFI' "> <i class="fa-solid fa-wifi"></i></div>
                <div *ngIf="item.name=='Mini fridge'"> <i class="fa-solid fa-road-bridge"></i> </div>
                <div *ngIf="item.name=='Sea view'"> <i class="fa-solid fa-water"></i></div>
                <div *ngIf="item.name=='coffe machine' || item.name=='Coffee maker'"> <i
                    class="fa-solid fa-mug-hot"></i></div>
                <div *ngIf="item.name=='Kids area'"> <i class="fa-solid fa-child-reaching"></i> </div>
                <div *ngIf="item.name=='Pets allowed'"> <i class="fa-solid fa-shield-cat"></i></div>
                <div *ngIf="item.name=='Lounges'"> <i class="fa-solid fa-dumbbell"></i></div>
                <div *ngIf="item.name=='Dining & Restaurants'"> <i class="fa-solid fa-utensils"></i></div>
                <div *ngIf="item.name=='Buffet'"> <i class="fa-solid fa-bowl-rice"></i></div>
                <div *ngIf="item.name=='air conditioning'"> <i class="fa-solid fa-fan"></i></div>
                <div *ngIf="item.name!=='Buffet' && item.name!=='Dining & Restaurants' && item.name!=='Mini fridge' &&
                item.name!=='Kitchen' && item.name!=='Garage' && item.name!=='Xbox' && item.name!=='Royal suite' && item.name!=='WIFI' &&
                item.name!=='Coffee maker' && item.name!=='Sea view' && item.name!=='Lounges' && item.name!=='Wifi' &&
                item.name!=='Pets allowed' && item.name!=='Kids area' && item.name!=='coffe machine' && item.name!=='air conditioning'">
                 <i class="fa-solid fa-gift"></i></div>
                {{item.name}}
              </div>
            </div>
          </div>
          <div *ngIf="roomRes.facilities.length==0">
            <h5>No Facilities For This Room</h5>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <mat-card class="example-card">
          <mat-card-header>
            <mat-card-subtitle class="subTitle mb-3">Start Booking </mat-card-subtitle>
            <mat-card-title class="title mb-2"> <span class="price">${{roomRes.price}}</span> per
              night</mat-card-title>
            <mat-card-subtitle> <span class="discount">Discount ${{roomRes.discount}} Off</span> </mat-card-subtitle>
          </mat-card-header>
          <mat-card-content class="mt-5">
            <h5>Pick a date</h5>
            <mat-form-field class="example-form-field w-100">
              <mat-label>Date</mat-label>
              <mat-date-range-input [formGroup]="campaignOne" [rangePicker]="campaignOnePicker"
                [comparisonStart]="campaignOne.value.start" [comparisonEnd]="campaignOne.value.end">
                <input matStartDate placeholder="Start date" formControlName="start">
                <input matEndDate placeholder="End date" formControlName="end">
              </mat-date-range-input>
              <mat-datepicker-toggle matIconSuffix [for]="campaignOnePicker"></mat-datepicker-toggle>
              <mat-date-range-picker #campaignOnePicker></mat-date-range-picker>
            </mat-form-field>
            <p>
              You will pay <span class="card-span">${{ getDiscountedPrice(roomRes.price, roomRes.discount
                ,roomRes.capacity) }}</span> per
              <span class="card-span">{{roomRes.capacity}} Person</span>
            </p>
            <div class="d-flex align-items-center justify-content-center">
              <button class="primary">Continue Book</button>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
     <!-- review and rate  Section -->
     <div class="row mt-3 mb-5 ">
    <div class="col-md-12 px-5 py-3 mb-5 ">
      <h5 class="mb-4">
        Comments & Reviews
      </h5>
      <mat-accordion class="example-headers-align" multi>
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
            Comments
            </mat-panel-title>
            <mat-panel-description>
              See all comments
              <mat-icon>chat</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>
              <ng-container *ngIf="commentsResponse.roomComments.length >0">
                <div class="row ">
                  <div class="col-md-12">
                    <div class="card " *ngFor=" let comment of commentsResponse.roomComments">
                      <div class="card-body p-4">
                        <div class="row  d-flex align-items-center">
                          <div class="col-lg-9  col-md-7 my-2">
                            <div class="d-flex flex-start align-items-center">
                              <img class="rounded-circle shadow-1-strong me-3"
                                [src]="comment.user.profileImage"
                                 alt="avatar" width="65"
                                height="65" />
                              <div class="flex-grow-1 flex-shrink-1">
                                <div>
                                  <div class="d-flex justify-content-between align-items-center">
                                    <p class="mb-1">
                                     {{comment.user.userName}} <span class="small">{{comment.createdAt |date}}</span>
                                    </p>                
                                  </div>
                                  <p class="small mb-0">
                                   {{comment.comment}}
                                  </p>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="col-lg-3 col-md-5 my-2 p-0  d-flex justify-content-between align-items-center">
                            <button (click)="updateComment(comment._id , comment.comment )" class="primary w-50 mx-2">Update</button>
                            <button (click)="deleteComment( comment._id  ,comment.comment) " class="delete  w-50">Delete</button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </ng-container>
              <ng-container *ngIf="commentsResponse.roomComments.length == 0">
                <p>No comments yet</p>
              </ng-container>
        </mat-expansion-panel>
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
             Reviews
            </mat-panel-title>
            <mat-panel-description>
             See all reviews
              <mat-icon>reviews</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>
          <ng-container *ngIf="reviewsResponse.roomReviews.length>0">
            <div class="row d-flex align-items-center">
              <div class="col-md-12 ">
                <div class="card " *ngFor=" let review of reviewsResponse.roomReviews">
                  <div class="card-body p-4 ">
                    <div class="row">
                      <div class="col-md-9  ">
                        <div class="d-flex flex-start">
                          <img class="rounded-circle shadow-1-strong me-3"
                            [src]="review.user.profileImage"
                             alt="avatar" width="65"
                            height="65" />
                          <div class="flex-grow-1 flex-shrink-1">
                            <div>
                              <div class="d-flex justify-content-between align-items-center">
                                <p class="mb-1">
                                 {{review.user.userName}} <span class="small">{{review.createdAt |date}}</span>
                                </p>                  
                              </div>
                              <p class="small mb-2">
                               {{review.review}}
                              </p>
                              <div class="">
                                <star-rating-control [starType]="'svg'"  class="star filled ms-5"
                                [numOfStars]="review.rating"></star-rating-control>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ng-container>
          <ng-container *ngIf="reviewsResponse.roomReviews.length == 0">
            <p>No Reviews yet</p>
          </ng-container>  
        </mat-expansion-panel>
      </mat-accordion>
    </div>
    </div>
    <!-- Rate Section -->
    <div class="col-md-12 px-5 py-3 mb-5 rate-card h-auto">
      <div class="row ">
        <div class="col-md-6 p-3 ">
          <form [formGroup]="reviewForm" (ngSubmit)="onAddReview(reviewForm)">
            <div class="" >
              <h3 class="mb-1">Rate</h3>
              <div class="d-flex justify-content-start align-items-center  ">
                <star-rating-control formControlName="rating" [starType]="'svg'" [rating]="rating"
                  [numOfStars]="4"></star-rating-control>
              </div>
            </div>
            <div class=" " >
              <div class="my-3">
                <label for="message" class="my-4">Message</label>
                <textarea formControlName="review" name="message" rows="5" id="message" class="form-control"></textarea>
              </div>
              <div class="w-100  text-end ">
              <button type="submit" [disabled]="reviewForm.invalid" class="primary w-25 mt-3">Rate</button>
              </div>
            </div>
          </form>
        </div>
        <!-- Add Your Comment section -->
        <div class="col-md-6 p-3 ">
          <form [formGroup]="commentForm" (ngSubmit)="onAddComment(commentForm.value)">
            <div class="" >
              <h3 class="mb-1">Add Your Comment</h3>
              <div class="d-flex justify-content-start align-items-center  opacity-0">
                <star-rating-control  [starType]="'svg'" [rating]="rating"
                  [numOfStars]="4"></star-rating-control>
              </div>
            </div>
            <div class=" " >
              <div class="my-3">
                <label for="comment" class="my-4">Comment</label>
                <textarea formControlName="comment" name="message" rows="5" id="message"
                  class="form-control"></textarea>
              </div>
              <div class="w-100  text-end ">
                <button type="submit" [disabled]="commentForm.invalid" class="primary w-25 mt-3 ">Send</button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>